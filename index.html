<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operalta â€” AI Startup Advisor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        
        :root {
            --grid-color: #f0f0f0;
            --accent: #5B21B6;
            --color-recording: #ff3b30;
            --glass-bg: rgba(255, 255, 255, 0.65);
            --glass-border: rgba(0, 0, 0, 0.07);
            --glass-shadow: rgba(0, 0, 0, 0.05);
            --glass-recording-bg: rgba(248, 248, 248, 0.75);
            --glass-recording-border: rgba(0, 0, 0, 0.1);
        }
        
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #F9FAFB;
        }
        
        .font-space-grotesk { font-family: 'Space Grotesk', sans-serif; }
        .font-space-mono { font-family: 'Space Mono', monospace; }

        .main-grid {
            background-image:
                linear-gradient(to right, var(--grid-color) 1px, transparent 1px),
                linear-gradient(to bottom, var(--grid-color) 1px, transparent 1px);
            background-size: 2rem 2rem;
        }

        .glass-card {
            background-color: var(--glass-bg);
            border: 1px solid var(--glass-border);
            box-shadow: 0 4px 30px var(--glass-shadow);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        .nav-link.active {
            background-color: var(--accent);
            color: white;
        }
        .playbook-category-btn.active {
            background-color: var(--accent);
            color: white;
            border-color: var(--accent);
        }
        .playbook-category-btn:not(.active):hover {
            border-color: #D1D5DB;
        }

        /* Chat UI styles */
        .chat-bubble-ai {
            background-color: #f3f4f6;
            border-radius: 1.5rem;
            border-bottom-left-radius: 0.25rem;
        }
        .chat-bubble-user {
            background-color: #4f46e5;
            color: white;
            border-radius: 1.5rem;
            border-bottom-right-radius: 0.25rem;
        }
        .chat-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px var(--accent);
            border-color: var(--accent);
        }
        .step-button {
            transition: all 0.2s ease-in-out;
        }
        .step-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="main-grid">
    <div class="min-h-screen flex flex-col md:flex-row p-4 gap-4">

        <!-- Sidebar Navigation -->
        <nav id="main-nav" class="glass-card rounded-2xl w-full md:w-64 p-4 flex flex-col">
            <div class="flex items-center gap-2 mb-8">
                <div class="bg-violet-700 text-white font-bold text-xl rounded-lg w-10 h-10 flex items-center justify-center">O</div>
                <h1 class="text-2xl font-bold font-space-grotesk text-gray-800">Operalta</h1>
            </div>
            <div class="flex-grow space-y-2">
                <a href="#" id="nav-dashboard" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-700 hover:bg-violet-100 transition-colors duration-200">
                    <i class="fas fa-chart-pie w-5 text-center"></i> Dashboard
                </a>
                <a href="#" id="nav-reports" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-700 hover:bg-violet-100 transition-colors duration-200">
                    <i class="fas fa-file-alt w-5 text-center"></i> Reports
                </a>
                <a href="#" id="nav-playbooks" class="nav-link active flex items-center gap-3 px-4 py-2 rounded-lg text-gray-700 hover:bg-violet-100 transition-colors duration-200">
                    <i class="fas fa-book-open w-5 text-center"></i> AI Co-pilot
                </a>
            </div>
            <div class="mt-auto">
                 <div class="flex items-center p-2 rounded-lg">
                    <img src="https://placehold.co/40x40/5B21B6/FFFFFF?text=A" alt="User Avatar" class="rounded-full mr-3">
                    <div>
                        <p class="font-semibold text-gray-800">Alex Grant</p>
                        <p class="text-sm text-gray-500">Founder, CEO</p>
                    </div>
                </div>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="flex-1 glass-card rounded-2xl p-6 md:p-8">
            <!-- Page: Dashboard -->
            <div id="page-dashboard" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-gray-800">Founder Dashboard</h2>
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200">
                    <h3 class="text-xl font-semibold mb-2">Create New Report</h3>
                    <p class="text-gray-600 mb-4">Record a short voice memo (2-5 mins) about your company's progress, wins, and challenges this week.</p>
                    <div id="dictation-ui" class="space-y-4">
                         <div>
                            <label for="gemini-api-key" class="block text-sm font-medium text-gray-700 mb-1">Gemini API Key</label>
                            <input type="password" id="gemini-api-key" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500" placeholder="Enter your Gemini API Key">
                        </div>
                        <button id="record-btn" class="bg-violet-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-violet-700 transition-all duration-200 w-full md:w-auto flex items-center justify-center gap-2 disabled:opacity-50" disabled>
                            <i class="fas fa-microphone"></i> <span id="record-btn-text">Start Recording</span>
                        </button>
                        <div id="recording-status" class="hidden items-center gap-3 text-lg font-semibold text-gray-700">
                            <div class="relative w-6 h-6">
                                <div class="absolute inset-0 bg-red-500 rounded-full animate-ping"></div>
                                <div class="relative bg-red-500 rounded-full w-6 h-6"></div>
                            </div>
                            <span id="timer">00:00</span>
                        </div>
                        <div id="processing-indicator" class="hidden">
                            <p class="font-semibold text-violet-700">Processing your memo with AI... This may take a moment.</p>
                            <div class="mt-2 w-full bg-gray-200 rounded-full h-2.5">
                                <div class="bg-violet-600 h-2.5 rounded-full animate-pulse"></div>
                            </div>
                        </div>
                        <div id="report-output" class="hidden prose max-w-none prose-headings:font-space-grotesk prose-headings:text-gray-800"></div>
                        <div id="report-actions" class="hidden">
                            <button id="finalize-report-btn-2" class="mt-4 bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700">Finalize & Share Report</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Page: Reports -->
            <div id="page-reports" class="page hidden">
                <h2 class="text-3xl font-bold mb-6 text-gray-800">Investor Reports</h2>
                <!-- Reports list will be populated here -->
            </div>

            <!-- Page: AI Co-pilot / Playbooks -->
            <div id="page-playbooks" class="page">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">AI Co-pilot</h2>
                    <button id="toggle-playbook-view-btn" class="text-sm font-semibold text-violet-600 hover:text-violet-800">
                        <i class="fas fa-book mr-1"></i> Browse Playbook Library
                    </button>
                </div>

                <!-- Conversational UI -->
                <div id="conversational-view" class="flex flex-col h-[calc(100vh-12rem)] bg-white rounded-2xl border border-gray-200 shadow-sm">
                    <div id="chat-history" class="flex-1 p-6 overflow-y-auto space-y-6">
                        <!-- Messages will be appended here -->
                    </div>
                    <div class="p-4 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
                        <div class="flex items-center gap-3">
                            <input type="text" id="chat-input" class="flex-1 p-3 border border-gray-300 rounded-full focus:ring-2 focus:ring-violet-500 focus:border-transparent transition" placeholder="Describe your biggest challenge this week...">
                            <button id="chat-send-btn" class="bg-violet-600 text-white rounded-full w-12 h-12 flex items-center justify-center hover:bg-violet-700 transition">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Library View (Initially Hidden) -->
                <div id="library-view" class="hidden">
                    <div id="playbook-category-filters" class="flex flex-wrap gap-2 mb-6">
                        <!-- Category buttons will be populated here -->
                    </div>
                    <div id="ceo-playbooks-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Playbook cards will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- Modal -->
            <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
                <div id="modal-content" class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto p-8 relative">
                    <button id="modal-close-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 text-2xl">&times;</button>
                    <!-- Modal content goes here -->
                </div>
            </div>
        </main>
    </div>

    <script type="module">
        // Mock Database
        const db = {
            playbooks: {
                "G.A.01": {
                    title: "The Product-Market Fit Engine",
                    category: "Go-To-Market",
                    stage: "Seed",
                    steps: [
                        { "title": "Diagnostic (Symptoms)", "content": "Stagnant user growth, high churn after signup, lukewarm user feedback ('It's a nice-to-have'). Your team feels like they are pushing a boulder uphill." },
                        { "title": "Recommended Actions", "content": "Implement the Superhuman PMF survey. Ask users: 'How would you feel if you could no longer use our product?'. Segment users who answer 'Very disappointed'." },
                        { "title": "Founder/CEO Validation", "content": "Crucial question: 'Are we brave enough to ignore the users who would only be 'somewhat disappointed' to double down on what makes our core users successful?'" },
                        { "title": "Implementation", "content": "Use a simple survey tool (Tally, SurveyMonkey). Trigger the survey via email after a user has been active for ~2 weeks. Focus all product and marketing efforts on the 'Very disappointed' user segment." },
                        { "title": "Expected Result", "content": "A crystal-clear, focused product roadmap. A renewed sense of energy and purpose for the team. Marketing messaging becomes sharp and effective because you know exactly who you're talking to." },
                        { "title": "Measured Impact (KPI)", "content": "The primary KPI is the percentage of users answering 'Very disappointed'. The goal is to get this above 40%. Track this metric weekly." }
                    ]
                },
                "P.S.04": {
                    title: "Tech Debt & Scaling",
                    category: "Product",
                    stage: "Seed",
                    steps: [
                        { "title": "Diagnostic (Symptoms)", "content": "Feature velocity has slowed dramatically. Small changes cause unexpected bugs elsewhere in the system. Engineers are becoming frustrated and burned out. The system feels 'brittle'." },
                        { "title": "Recommended Actions", "content": "Declare a 'fix-it' sprint or cycle (2-4 weeks). Halt all new feature development. Create a prioritized list of technical debt items based on their impact on developer velocity and system stability." },
                        { "title": "Founder/CEO Validation", "content": "Crucial question: 'Can we, as a business, afford to pause new features for a short period to invest in our long-term speed and stability? Do we trust our engineering team to make the right calls?'" },
                        { "title": "Implementation", "content": "Empower the engineering team to lead the process. They own the backlog and the execution. The CEO's job is to protect this time fiercely from stakeholder requests for 'just one small feature'." },
                        { "title": "Expected Result", "content": "A more stable and reliable platform. A significant boost in engineering team morale and confidence. A noticeable increase in development velocity in the months following the 'fix-it' cycle." },
                        { "title": "Measured Impact (KPI)", "content": "Track 'Cycle Time' (time from commit to deploy) and 'Deployment Frequency'. Both should improve post-cycle. Also, qualitatively survey engineer happiness." }
                    ]
                },
                "PC.A.03": {
                    title: "Combating Team Burnout",
                    category: "People & Culture",
                    stage: "All",
                     steps: [
                        { "title": "Diagnostic (Symptoms)", "content": "Team members seem disengaged or cynical. Increased mistakes, missed deadlines, and a general lack of proactive energy. You might hear complaints about being 'always on' or having 'too many meetings'." },
                        { "title": "Recommended Actions", "content": "Conduct an 'Energy Audit' (inspired by Matt Mochary). Have each team member list activities that give them energy vs. drain their energy. Implement 'No-Meeting Fridays' to create deep work time." },
                        { "title": "Founder/CEO Validation", "content": "Crucial question: 'Are we willing to fundamentally change how we work, even if it feels less 'productive' in the short term, to protect our team's long-term health and creativity?'" },
                        { "title": "Implementation", "content": "Publicly acknowledge the issue and the plan. The leadership team must model the desired behavior (e.g., actually disconnecting on weekends). Re-evaluate workloads and project plans for realism." },
                        { "title": "Expected Result", "content": "A palpable increase in team energy and morale. Better decision-making and creativity as people have more mental space. Retention of key team members improves." },
                        { "title": "Measured Impact (KPI)", "content": "This is primarily qualitative. Run a simple team 'pulse' survey before and after implementing changes, asking for a rating (1-10) on energy levels and work-life balance. Goal is a >2 point increase." }
                    ]
                },
                 "O.A.02": {
                    title: "The Company Operating Cadence",
                    category: "Finance & Operations",
                    stage: "Seed",
                     steps: [
                        { "title": "Diagnostic (Symptoms)", "content": "Communication feels chaotic and inconsistent. Teams are misaligned on priorities. Meetings feel reactive and unproductive. You find yourself repeating the same information in different forums." },
                        { "title": "Recommended Actions", "content": "Establish a clear meeting rhythm: Weekly Business Review (WBR) for tactical updates, Monthly Business Review (MBR) for progress against goals, and Quarterly Business Review (QBR) for strategy." },
                        { "title": "Founder/CEO Validation", "content": "Crucial question: 'Are we disciplined enough to stick to a structured meeting schedule and hold each other accountable for preparing for and participating in these meetings effectively?'" },
                        { "title": "Implementation", "content": "Define a clear agenda and owner for each meeting. WBRs are for data, not discussion. MBRs are for analyzing trends. QBRs are for strategic course-correction. Document and share notes from every meeting." },
                        { "title": "Expected Result", "content": "A dramatic increase in alignment and clarity across the company. Fewer, but more effective, meetings. Faster decision-making because information flows predictably. A calmer, more professional operating rhythm." },
                        { "title": "Measured Impact (KPI)", "content": "Success is measured by the consistency and quality of the meetings themselves. A secondary metric is a reduction in ad-hoc 'update' meetings. Survey the team on their perception of company alignment." }
                    ]
                }
            },
            diagnosticKeywords: {
                "G.A.01": ["growth has stalled", "stagnant", "churn", "drop off", "lukewarm feedback", "nice-to-have"],
                "P.S.04": ["shipping slower", "slow velocity", "bugs", "brittle", "technical debt", "tech debt", "engineers frustrated"],
                "PC.A.03": ["burnout", "burned out", "tired", "disengaged", "cynical", "too many meetings", "always on"],
                "O.A.02": ["misaligned", "chaotic", "communication", "unproductive meetings", "repeating myself", "no alignment"]
            }
        };

        const ui = {
            navLinks: document.querySelectorAll('.nav-link'),
            pages: document.querySelectorAll('.page'),
            modal: document.getElementById('modal'),
            modalContent: document.getElementById('modal-content'),
            modalCloseBtn: document.getElementById('modal-close-btn'),
            togglePlaybookViewBtn: document.getElementById('toggle-playbook-view-btn'),
            conversationalView: document.getElementById('conversational-view'),
            libraryView: document.getElementById('library-view'),
            chatHistory: document.getElementById('chat-history'),
            chatInput: document.getElementById('chat-input'),
            chatSendBtn: document.getElementById('chat-send-btn'),
            playbookCategoryFilters: document.getElementById('playbook-category-filters'),
            ceoPlaybooksGrid: document.getElementById('ceo-playbooks-grid'),
        };

        let currentView = 'chat'; // 'chat' or 'library'
        let conversationState = {
            activePlaybook: null,
            currentStep: 0
        };

        function showPage(pageId) {
            ui.pages.forEach(page => page.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');

            ui.navLinks.forEach(link => link.classList.remove('active'));
            document.getElementById(`nav-${pageId.split('-')[1]}`).classList.add('active');
        }

        function showModal(content) {
            ui.modalContent.innerHTML = content;
             ui.modalContent.insertAdjacentHTML('afterbegin', `<button id="modal-close-btn-inner" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 text-2xl">&times;</button>`);
            ui.modal.classList.remove('hidden');
            ui.modal.classList.add('flex');
            document.getElementById('modal-close-btn-inner').addEventListener('click', hideModal);
        }

        function hideModal() {
            ui.modal.classList.add('hidden');
            ui.modal.classList.remove('flex');
        }

        // --- Playbook Page Logic ---
        function togglePlaybookView() {
            if (currentView === 'chat') {
                ui.conversationalView.classList.add('hidden');
                ui.libraryView.classList.remove('hidden');
                ui.togglePlaybookViewBtn.innerHTML = `<i class="fas fa-comments mr-1"></i> Switch to AI Co-pilot`;
                currentView = 'library';
            } else {
                ui.libraryView.classList.add('hidden');
                ui.conversationalView.classList.remove('hidden');
                ui.togglePlaybookViewBtn.innerHTML = `<i class="fas fa-book mr-1"></i> Browse Playbook Library`;
                currentView = 'chat';
            }
        }
        
        function populateCeoPlaybooks() {
            const categories = [...new Set(Object.values(db.playbooks).map(p => p.category))];
            ui.playbookCategoryFilters.innerHTML = categories.map(c => `<button class="playbook-category-btn border border-gray-300 rounded-full px-4 py-1 text-sm font-semibold text-gray-700 hover:border-gray-400 transition">${c}</button>`).join('');

            ui.ceoPlaybooksGrid.innerHTML = Object.entries(db.playbooks).map(([id, playbook]) => `
                <div class="bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col">
                    <span class="text-xs font-semibold text-violet-600 uppercase">${playbook.category}</span>
                    <h3 class="text-lg font-bold text-gray-800 mt-1 mb-2">${playbook.title}</h3>
                    <p class="text-sm text-gray-600 flex-grow">${playbook.steps[0].content.substring(0, 100)}...</p>
                    <button class="view-playbook-btn mt-4 text-sm font-bold text-violet-600 hover:text-violet-800 self-start" data-playbook-id="${id}">View Playbook &rarr;</button>
                </div>
            `).join('');
            
            document.querySelectorAll('.view-playbook-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const playbookId = e.currentTarget.dataset.playbookId;
                    const playbook = db.playbooks[playbookId];
                    const content = `
                        <h2 class="text-2xl font-bold mb-4">${playbook.title}</h2>
                        <div class="space-y-4">
                            ${playbook.steps.map(step => `
                                <div>
                                    <h4 class="font-semibold text-violet-700">${step.title}</h4>
                                    <p class="text-gray-700">${step.content}</p>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    showModal(content);
                });
            });
        }
        
        // --- Conversational AI Logic ---

        function addMessageToHistory(message, sender) {
            const bubble = document.createElement('div');
            bubble.className = `max-w-xl p-4 ${sender === 'user' ? 'chat-bubble-user self-end' : 'chat-bubble-ai self-start'}`;
            
            // Basic markdown parsing for bold
            message = message.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');

            bubble.innerHTML = `<p>${message}</p>`;
            ui.chatHistory.appendChild(bubble);
            ui.chatHistory.scrollTop = ui.chatHistory.scrollHeight;
        }
        
        function addOptionsToHistory(options) {
            const optionsContainer = document.createElement('div');
            optionsContainer.className = 'flex flex-wrap gap-3 justify-start pt-2';
            optionsContainer.innerHTML = options.map(opt => 
                `<button class="step-button bg-white border border-violet-200 text-violet-700 text-sm font-semibold px-4 py-2 rounded-full hover:bg-violet-50" data-action="${opt.action}" data-value="${opt.value}">${opt.label}</button>`
            ).join('');
            
            ui.chatHistory.appendChild(optionsContainer);
            ui.chatHistory.scrollTop = ui.chatHistory.scrollHeight;

            optionsContainer.addEventListener('click', (e) => {
                const target = e.target.closest('.step-button');
                if (!target) return;
                
                const action = target.dataset.action;
                const value = target.dataset.value;

                // Visually confirm selection and disable options
                optionsContainer.querySelectorAll('.step-button').forEach(btn => {
                    btn.disabled = true;
                    btn.classList.add('opacity-50');
                    if(btn === target) {
                        btn.classList.add('bg-violet-600', 'text-white');
                    }
                });

                handleUserAction(action, value);
            });
        }

        function handleUserMessage() {
            const message = ui.chatInput.value.trim();
            if (!message) return;

            addMessageToHistory(message, 'user');
            ui.chatInput.value = '';

            setTimeout(() => processFounderMessage(message), 1000);
        }

        function diagnoseProblem(message) {
            const lowerMessage = message.toLowerCase();
            for (const [playbookId, keywords] of Object.entries(db.diagnosticKeywords)) {
                if (keywords.some(kw => lowerMessage.includes(kw))) {
                    return playbookId;
                }
            }
            return null;
        }

        function processFounderMessage(message) {
            const playbookId = diagnoseProblem(message);

            if (playbookId) {
                conversationState.activePlaybook = playbookId;
                conversationState.currentStep = 0;

                const playbook = db.playbooks[playbookId];
                addMessageToHistory(`Thanks for sharing that. It sounds like you might be running into issues related to **${playbook.category}**.`, 'ai');
                setTimeout(() => {
                    addMessageToHistory(`Based on what you said, the system recommends we focus on the **${playbook.title}** playbook.`, 'ai');
                    setTimeout(() => {
                        presentPlaybookStep();
                    }, 1200);
                }, 1000);

            } else {
                addMessageToHistory("I'm not sure I fully understand the core problem. Could you describe the main challenge you're facing in a bit more detail? For example, are you dealing with slow growth, engineering bottlenecks, or team issues?", 'ai');
            }
        }
        
        function presentPlaybookStep() {
            if (!conversationState.activePlaybook) return;

            const playbook = db.playbooks[conversationState.activePlaybook];
            const step = playbook.steps[conversationState.currentStep];

            addMessageToHistory(`**Step ${conversationState.currentStep + 1}: ${step.title}**\n\n${step.content}`, 'ai');

            setTimeout(() => {
                if (conversationState.currentStep < playbook.steps.length - 1) {
                     addOptionsToHistory([
                        { label: "Okay, let's proceed.", action: 'next_step', value: '' },
                        { label: "Tell me more about this.", action: 'explain_more', value: '' }
                    ]);
                } else {
                    addMessageToHistory("You've completed the playbook. This is a huge step! The key is consistent execution.", 'ai');
                    setTimeout(() => {
                         addMessageToHistory("I'll set a reminder to check back in with you in three weeks to see how your key metric is progressing. Keep up the great work, Alex.", 'ai');
                         resetConversation();
                    }, 1500);
                }
            }, 1000);
        }
        
        function handleUserAction(action, value) {
            if (action === 'next_step') {
                conversationState.currentStep++;
                presentPlaybookStep();
            } else if (action === 'explain_more') {
                addMessageToHistory("This step is crucial because it defines the problem with clear, observable symptoms. Getting alignment on *what* the problem looks and feels like is the foundation for solving it effectively. Without this, teams often solve the wrong problem.", 'ai');
                 setTimeout(() => {
                    addOptionsToHistory([
                        { label: "Got it. Let's continue.", action: 'next_step', value: '' },
                    ]);
                }, 1000);
            }
        }
        
        function resetConversation() {
            conversationState.activePlaybook = null;
            conversationState.currentStep = 0;
        }

        function initializeChat() {
            setTimeout(() => {
                addMessageToHistory("Welcome back, Alex. What's the biggest challenge on your mind this week?", 'ai');
            }, 500);
        }

        // --- Event Listeners & Initial Load ---
        document.addEventListener('DOMContentLoaded', () => {
            showPage('page-playbooks');
            populateCeoPlaybooks();

            ui.navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = `page-${e.currentTarget.id.split('-')[1]}`;
                    showPage(pageId);
                });
            });

            ui.togglePlaybookViewBtn.addEventListener('click', togglePlaybookView);
            ui.modalCloseBtn.addEventListener('click', hideModal);
            document.getElementById('modal').addEventListener('click', (e) => {
                if (e.target.id === 'modal') hideModal();
            });
            
            ui.chatSendBtn.addEventListener('click', handleUserMessage);
            ui.chatInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleUserMessage();
            });

            initializeChat();
        });
    </script>
</body>
</html>
